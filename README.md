# Python Backend Project

Этот проект представляет собой бэкенд-приложение на Python, использующее Flask для создания RESTful API и RabbitMQ для обработки сообщений. В проекте также реализована интеграция с Prometheus для мониторинга и Grafana для визуализации метрик.

## Архитектура проекта

Проект состоит из следующих компонентов:

- **Flask Server**: Основной сервер, который обрабатывает HTTP-запросы для создания и получения заказов.
- **Consumer**: Компонент, который слушает очередь RabbitMQ и обрабатывает сообщения о новых заказах.
- **Prometheus**: Система мониторинга, которая собирает метрики с сервера.
- **Grafana**: Инструмент для визуализации метрик, собранных Prometheus.
- **PostgreSQL**: База данных для хранения информации о заказах.

### Структура проекта

/project-root<br/>
│<br/>
├── server/ # Код сервера Flask<br/>
│ ├── main.py # Основной файл приложения<br/>
│ ├── db.py # Файл базы данных<br/>
│ ├── metrics.py # Файл для сбора метрик<br/>
│ └── requirements.txt # Зависимости для сервера<br/>
│<br/>
├── consumer/ # Код консюмера<br/>
│ ├── consumer.py # Основной файл консюмера<br/>
│ └── requirements.txt # Зависимости для консюмера<br/>
│<br/>
├── prometheus/ # Конфигурация Prometheus<br/>
│ └── prometheus.yml # Файл конфигурации Prometheus<br/>
│<br/>
├── docker-compose.yml # Файл для сборки всех сервисов с помощью Docker<br/>
│<br/>
├── tests/ # Тесты для сервера и консюмера<br/>
│ ├── test_server.py # Тесты для сервера Flask<br/>
│ └── test_consumer.py # Тесты для консюмера<br/>
│<br/>
└── README.md # Этот файл

## Установка и запуск

1. **Клонируйте репозиторий**:<br/>
  git clone https://github.com/Modunga1/Python_HW.git <br/>
  cd Python_HW

3. **Запустите приложение**:
  docker-compose up --build


Это создаст и запустит следующие контейнеры:
- Flask сервер (порт 8000)
- Consumer (обрабатывает сообщения из RabbitMQ)
- RabbitMQ (для обработки сообщений)
- PostgreSQL (для хранения данных о заказах)
- Prometheus (для сбора метрик)
- Grafana (для визуализации метрик)

## Использование

### Эндпоинты сервера

- **Создание заказа**:
  - `POST /orders`
  - Пример запроса:
    ```
    {
      "item_name": "Товар 1"
    }
    ```

- **Получение заказа по ID**:
  - `GET /orders/<order_id>`

- **Проверка работоспособности**:
  - `GET /health`

### Мониторинг с Prometheus и Grafana

Prometheus будет собирать метрики с вашего Flask-сервера каждые 15 секунд по адресу `http://flask_app:8000`.

Grafana будет доступна по адресу `http://localhost:3000`. Используйте стандартные учетные данные:
- Логин: `admin`
- Пароль: `admin`

После первого входа вам будет предложено изменить пароль.

## Тестирование

Тестирование производиться автоматически с помощью github action

